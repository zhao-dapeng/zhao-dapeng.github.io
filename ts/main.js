(()=>{const v=function(a){return new Promise(b=>{var c=document.createElement("script");c.src=a,c.onload=()=>{b()},document.head.appendChild(c)})},w=function(a){return new Promise(b=>{var c=document.createElement("link");c.href=a,c.type="text/css",c.rel="stylesheet",c.onload=()=>{b()},document.head.appendChild(c)})};var D=function(a){for(var b=function(g){for(var f=g.childNodes,e=f.length,m=[],h,p,j,k,l=0;l<e;l++){h=f[l];if(h.nodeType!==1)continue;p=h.children[0],j=p.getAttribute("data-size").split("x"),k={src:p.getAttribute("href"),w:parseInt(j[0],10),h:parseInt(j[1],10)},h.children.length>1&&(k.title=h.children[1].innerHTML),p.children.length>0&&(k.msrc=p.children[0].getAttribute("src")),k.el=h,m.push(k)}return m},c=function g(f,e){return f&&(e(f)?f:g(f.parentNode,e))},d=function(g){g=g||window.event,g.preventDefault?g.preventDefault():g.returnValue=!1;var f=g.target||g.srcElement,e=c(f,function(t){return t.tagName&&t.tagName.toUpperCase()==="FIGURE"});if(!e)return;for(var m=e.parentNode,h=e.parentNode.childNodes,p=h.length,j=0,k,l=0;l<p;l++){if(h[l].nodeType!==1)continue;if(h[l]===e){k=j;break}j++}return k>=0&&n(k,m),!1},i=function(){var g=window.location.hash.substring(1),f={};if(g.length<5)return f;for(var e=g.split("&"),m=0;m<e.length;m++){if(!e[m])continue;var h=e[m].split("=");if(h.length<2)continue;f[h[0]]=h[1]}return f.gid&&(f.gid=parseInt(f.gid,10)),f},n=function(g,f,e,m){var h=document.querySelectorAll(".pswp")[0],p,j,k;k=b(f),j={galleryUID:f.getAttribute("data-pswp-uid"),getThumbBoundsFn:function(t){var I=k[t].el.getElementsByTagName("img")[0],J=window.pageYOffset||document.documentElement.scrollTop,y=I.getBoundingClientRect();return{x:y.left,y:y.top+J,w:y.width}}};if(m)if(j.galleryPIDs){for(var l=0;l<k.length;l++)if(k[l].pid==g){j.index=l;break}}else j.index=parseInt(g,10)-1;else j.index=parseInt(g,10);if(isNaN(j.index))return;e&&(j.showAnimationDuration=0),p=new PhotoSwipe(h,PhotoSwipeUI_Default,k,j),p.init()},o=document.querySelectorAll(a),q=0,x=o.length;q<x;q++)o[q].setAttribute("data-pswp-uid",q+1),o[q].onclick=d;var s=i();s.pid&&s.gid&&n(s.pid,o[s.gid-1],!0,!0)};function z(a){let b=document.createElement("div");b.className="gallery";let c=a[0].parentNode,d=a[0];c.insertBefore(b,d);for(let i=0;i<a.length;++i){const n=a[i].querySelector("img").width,o=a[i].querySelector("img").height;a[i].style.flexGrow=`${n*100/o}`,a[i].style.flexBasis=`${n*240/o}px`,b.appendChild(a[i])}}function E(){const a=[v("https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/photoswipe.min.js"),v("https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/photoswipe-ui-default.min.js"),w("https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/photoswipe.min.css"),w("https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/default-skin/default-skin.min.css")];return Promise.all(a)}function A(a){const b=document.querySelector(a).querySelectorAll("figure");if(b.length){let c=[b[0]];for(let d=1;d<b.length;++d)b[d].previousElementSibling===c[c.length-1]?c.push(b[d]):(z(c),c=[b[d]]);c.length>0&&z(c),E().then(()=>{const d=document.querySelector(".pswp");d.style.removeProperty("display"),D(`${a} .gallery`)})}}let r={};if(localStorage.hasOwnProperty("StackColorsCache"))try{r=JSON.parse(localStorage.getItem("StackColorsCache"))}catch(a){r={}}async function u(a,b,c){if(!a)return await Vibrant.from(c).getPalette();if(!r.hasOwnProperty(a)||r[a].hash!==b){const d=await Vibrant.from(c).getPalette();r[a]={hash:b,Vibrant:{hex:d.Vibrant.hex,rgb:d.Vibrant.rgb,bodyTextColor:d.Vibrant.bodyTextColor},DarkMuted:{hex:d.DarkMuted.hex,rgb:d.DarkMuted.rgb,bodyTextColor:d.DarkMuted.bodyTextColor}},localStorage.setItem("StackColorsCache",JSON.stringify(r))}return r[a]}let F=(a,b=500)=>{a.classList.add("transiting"),a.style.transitionProperty="height, margin, padding",a.style.transitionDuration=b+"ms",a.style.height=a.offsetHeight+"px",a.offsetHeight,a.style.overflow="hidden",a.style.height="0",a.style.paddingTop="0",a.style.paddingBottom="0",a.style.marginTop="0",a.style.marginBottom="0",window.setTimeout(()=>{a.classList.remove("show"),a.style.removeProperty("height"),a.style.removeProperty("padding-top"),a.style.removeProperty("padding-bottom"),a.style.removeProperty("margin-top"),a.style.removeProperty("margin-bottom"),a.style.removeProperty("overflow"),a.style.removeProperty("transition-duration"),a.style.removeProperty("transition-property"),a.classList.remove("transiting")},b)},G=(a,b=500)=>{a.classList.add("transiting"),a.style.removeProperty("display"),a.classList.add("show");let c=a.offsetHeight;a.style.overflow="hidden",a.style.height="0",a.style.paddingTop="0",a.style.paddingBottom="0",a.style.marginTop="0",a.style.marginBottom="0",a.offsetHeight,a.style.transitionProperty="height, margin, padding",a.style.transitionDuration=b+"ms",a.style.height=c+"px",a.style.removeProperty("padding-top"),a.style.removeProperty("padding-bottom"),a.style.removeProperty("margin-top"),a.style.removeProperty("margin-bottom"),window.setTimeout(()=>{a.style.removeProperty("height"),a.style.removeProperty("overflow"),a.style.removeProperty("transition-duration"),a.style.removeProperty("transition-property"),a.classList.remove("transiting")},b)},H=(a,b=500)=>window.getComputedStyle(a).display==="none"?G(a,b):F(a,b);function B(){const a=document.getElementById("toggle-menu");a&&a.addEventListener("click",()=>{if(document.getElementById("main-menu").classList.contains("transiting"))return;document.body.classList.toggle("show-menu"),H(document.getElementById("main-menu"),300),a.classList.toggle("is-active")})}let C={init:()=>{B(),document.querySelector(".article-content")&&A(".article-content"),document.querySelectorAll(".color-tag").forEach(async b=>{const c=b.getAttribute("data-image"),d=b.getAttribute("data-key"),i=b.getAttribute("data-hash"),n=await u(d,i,c);b.style.color=n.Vibrant.bodyTextColor,b.style.background=n.Vibrant.hex});const a=document.querySelector(".article-list--tile");if(a){let b=new IntersectionObserver(async(c,d)=>{c.forEach(i=>{if(!i.isIntersecting)return;d.unobserve(i.target);const n=i.target.querySelectorAll("article.has-image");n.forEach(async o=>{const q=o.querySelector("img"),x=q.src,s=q.getAttribute("data-key"),g=q.getAttribute("data-hash"),f=o.querySelector(".article-details"),e=await u(s,g,x);f.style.background=`
                        linear-gradient(0deg, 
                            rgba(${e.DarkMuted.rgb[0]}, ${e.DarkMuted.rgb[1]}, ${e.DarkMuted.rgb[2]}, 0.5) 0%, 
                            rgba(${e.Vibrant.rgb[0]}, ${e.Vibrant.rgb[1]}, ${e.Vibrant.rgb[2]}, 0.75) 100%)`})})});b.observe(a)}},alert:(a,b=5e3,c=500)=>{const d=document.createElement("div");d.innerHTML=a,d.className="alert",d.style.visibility="hidden",document.body.appendChild(d),d.style.transform=`translateY(${d.clientHeight+50}px)`,d.style.transition=`transform ${c/1e3}s ease`,setTimeout(()=>{d.style.removeProperty("visibility"),d.style.transform="translateY(0)"},c),setTimeout(()=>{d.style.transform=`translateY(${d.clientHeight+50}px)`},c+b),setTimeout(()=>{d.remove()},2*c+b)}};window.addEventListener("load",()=>{setTimeout(function(){C.init()},0)});window.Stack=C;})();
